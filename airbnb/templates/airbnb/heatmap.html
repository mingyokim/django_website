{% extends "airbnb/project.html" %}

{% block heatmap %}
<h1>Heatmap (BETA)</h1>

<div id="map" style="height:600px; width:100%;"></div>
<script>
	function initMap() {
		var newYork = new google.maps.LatLng(40.730610, -73.935242);

		map = new google.maps.Map(document.getElementById('map'), {
			center: newYork,
			zoom: 10,
			mapTypeId: 'satellite'
			
		});

		//map.data.loadGeoJson('http://data.insideairbnb.com/united-states/ny/new-york-city/2016-12-03/visualisations/neighbourhoods.geojson');
		//map.data.setStyle({fillOpacity: 0.01, strokeWeight: 1.75, strokeOpacity: 1, strokeColor: 'black'});
		
		var heatMapData = [];

		//var list = {{ allListings }}
		//for listing in list {
		//for {{ listing }} in {{allListings}} {
		{% for li in allListings %}
			var latitude = {{ listing.lat }};
			var longitude = {{ listing.long }};
			var obj = new google.maps.LatLng(latitude, longitude);
			heatMapData.push(obj);
		{% endfor %}

		var heatmap = new google.maps.visualization.HeatmapLayer({
			data: heatMapData,
			radius: 7,
			maxIntensity:25
		});
		heatmap.setMap(map);
	}
</script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script async defer
	src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDqCxxQq6OgSX6tQhihd-DfaBkyzR88vU8&callback=initMap&libraries=visualization">
</script>
{% endblock %}
